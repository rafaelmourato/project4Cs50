{% extends "network/layout.html" %}

{% block body %}
<div class="container mt-4 ">

    {% if request.user.is_authenticated %}
    <div class="card p-3 mb-4">
        <h4>New Post</h4>
        <form action="{% url 'index' %}" method="post">
            {% csrf_token %}
            <textarea name="content" class="form-control mb-2" placeholder="What's happening?"></textarea>
            <button class="btn btn-success">Post</button>
        </form>
    </div>
    {% endif %}

    {% for post in posts %}
    <div class="post-card border-bottom pb-3 pt-2">
        <div class="post-header">
            <a href="{% url 'profile' post.creator.username %}" class="post-author">
                {{ post.creator }}
            </a>
            <span class="post-time">{{ post.time }}</span>
        </div>

        <p id="content-{{ post.id }}">{{ post.content }}</p>

        {% if request.user == post.creator %}
            <button class="btn btn-sm btn-outline-secondary edit-btn" data-id="{{ post.id }}">Edit</button>
        {% else %}
            <button class="btn btn-sm btn-outline-primary like-btn" data-id="{{ post.id }}">
                {% if user in post.likes.all %}Unlike{% else %}Like{% endif %}
            </button>

            <span id="likes-{{ post.id }}" class="ms-2">
                {{ post.likes.count }}
            </span> likes
        {% endif %}
    </div>
    {% endfor %}

    {% include "network/pagination.html" %}

</div>
{% endblock %}